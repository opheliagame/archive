<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <meta name="author" content="opheliagame">
  <meta name="description" content="human | computer art">
  <meta property="og:image" content="">
  <meta property="og:description" content="human | computer art">
  <meta property="og:title" content="opheliagame">
  <meta property="twitter:description" content="human | computer art">
  <meta property="twitter:title" content="opheliagame">
  <meta property="twitter:creator" content="@anushkatr">

  <link href="https://cdn.jsdelivr.net/npm/prism-themes@1.7.0/themes/prism-material-light.css" rel="stylesheet">

  <link rel="stylesheet" href="/style.css" >
  <link rel="stylesheet" href="/extra.css" >

  <title>opheliagame</title>
</head>
<body style="background-color: #ffd6e0;">
  
  <div class="md:container md:mx-auto
              flex flex-col justify-between items-center
              px-4 md:px-32">
    <div class="flex justify-between w-full
                ">
      <header class="flex justify-between lg:justify-center items-center py-4 md:py-8 px-2">
  <a class="text-black no-underline" href="/">
    <h1 class="text-2xl md:text-3xl font-bold">
      opheliagame
    </h1>
  </a>
</header>
      <div class="flex flex-wrap gap-y-2 py-2 lg:px-24 col-span-full justify-between items-center text-xl">
  <a class="py-1 px-2 md:py-2 md:px-4" href="/">
    <span class="link-primary">about</span>
  </a>
  <a class="text-black no-underline py-1 px-2 md:py-2 md:px-4" href="/blog">
    <span class="link-primary">blog</span>
  </a>
</div>

    </div>

    <div class="px-2 w-full">
      <p class="py-2">This is definitely not a week after the last article. And I think a part of the reason is because I haven't been studying shaders consistently. But hey, I'm back here, and so that is a good sign right? I hope it is. So today I want to talk about textures and make a simple shader that pixelates an image.</p>
<h3 class="text-lg font-semibold">What is a texture you say</h3>
<p class="py-2">Simply put, texture is shader speak for image. When getting introduced to texture, and even during this article you will come across the term texture coordinates as well. Now this concept does not have a counterpart with respect to images, but it becomes inseparable from textures when it comes to shaders. If you have a texture, you must have texture coordinates.</p>
<p class="py-2">And this is the way it is because shaders have the capability to wrap a texture around 3D objects and in other ways as well. That is, you can use an image to cover a 3D model, for example a cylinder, in any number of ways you can imagine. To specify which part of an image goes where on a 2D plane or a 3D object, we need texture coordinates. This will become more clear as you use them yourself in a bit.</p>
<h3 class="text-lg font-semibold">What are we waiting for</h3>
<p class="py-2">So to begin, let's write all the simple boilerplate that we need for our shader, and you should see a red screen.</p>
<pre class="language-glsl"><code class="language-glsl"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">GL_ES</span></span><br><span class="token keyword">precision</span> <span class="token keyword">mediump</span> <span class="token keyword">float</span><span class="token punctuation">;</span><br><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><br><br><span class="token keyword">uniform</span> <span class="token keyword">vec2</span> u_resolution<span class="token punctuation">;</span><br><span class="token keyword">uniform</span> <span class="token keyword">vec2</span> u_mouse<span class="token punctuation">;</span><br><span class="token keyword">uniform</span> <span class="token keyword">float</span> u_time<span class="token punctuation">;</span><br><span class="token keyword">uniform</span> <span class="token keyword">sampler2D</span> u_texture_0<span class="token punctuation">;</span><br><br><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p class="py-2">You must have noticed that we have an extra uniform of type <code>sampler2D</code>, and this is our texture/image. If you are using <a href="https://marketplace.visualstudio.com/items?itemName=circledev.glsl-canvas" target="_blank" rel="noopener noreferrer">glsl-canvas</a> on VSCode then you can define your texture location in the <code>settings.json</code> file of your current workspace and will have to use the name <code>u_texture_0</code> for the uniform. For more information on how to do this, you can look into the Textures section on the <a href="https://marketplace.visualstudio.com/items?itemName=circledev.glsl-canvas" target="_blank" rel="noopener noreferrer">extension page</a>.</p>
<p class="py-2">But we are not done yet displaying our image, since we are not using the texture inside the shader at all yet. So let's go ahead and do that.</p>
<pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br>    <span class="token keyword">vec4</span> tex <span class="token operator">=</span> <span class="token function">texture2D</span><span class="token punctuation">(</span>u_texture_0<span class="token punctuation">,</span> st<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    gl_FragColor <span class="token operator">=</span> tex<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p class="py-2">To use a texture inside a shader, the function that glsl provides us is called <code>texture2D</code>. The first parameter for this function is the texture uniform and the second parameter is.. yes you guessed it, texture coordinates!</p>
<p class="py-2"><a href="https://unsplash.com/@geoffroyh?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" target="_blank" rel="noopener noreferrer"><img src="./post2-1.png" alt="displaying image using shader" title="Photo by Geoffroy Hauwen on Unsplash"></a></p>
<p class="py-2">Side note: as you can probably tell from the code, texture coordinates usually range from 0 to 1 although this might not be so in some cases. But it would be safe to assume the range 0-1 for most cases.</p>
<h3 class="text-lg font-semibold">PPiixxeellaattee</h3>
<p class="py-2">Now that we can display an image inside a shader, let's move to the next step and pixelate it. For doing this, do you think we should modify the texture coordinates, i.e. how we get pixels from an image, or the image after we get it using simple texture coordinates. Let's first try using the first approach.
And to get to that we'll first explore how to make a grid using a shader.</p>
<pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br><br>    <span class="token keyword">vec2</span> tex_coord <span class="token operator">=</span> st<span class="token punctuation">;</span><br>    <span class="token keyword">vec4</span> tex <span class="token operator">=</span> <span class="token function">texture2D</span><span class="token punctuation">(</span>u_texture_0<span class="token punctuation">,</span> tex_coord<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">float</span> grid <span class="token operator">=</span> <span class="token function">random</span><span class="token punctuation">(</span><span class="token function">floor</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// gl_FragColor = tex;</span><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>grid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p class="py-2">If we try to unpack this line which defines our <code>grid</code>, we can see that we are first upscaling or zooming out by multiplying <code>st</code> with a float value and then flooring the space to get floored values like <code>0.0, 1.0, 2.0, 3.0, 4.0..</code>. This flooring operation essentially divides our entire space into a grid. When picking randomly from this floored grid, we start to get closer to our idea of pixellation.</p>
<pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br><br>    <span class="token keyword">vec2</span> tex_coord <span class="token operator">=</span> st<span class="token punctuation">;</span><br>    <span class="token keyword">vec4</span> tex <span class="token operator">=</span> <span class="token function">texture2D</span><span class="token punctuation">(</span>u_texture_0<span class="token punctuation">,</span> tex_coord<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">vec2</span> grid <span class="token operator">=</span> <span class="token function">floor</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">10.0</span><span class="token punctuation">;</span><br><br>    <span class="token comment">// gl_FragColor = tex;</span><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>grid<span class="token punctuation">.</span>x<span class="token punctuation">,</span> grid<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p class="py-2"><img src="./post2-2.png" alt="'shader grid'"></p>
<p class="py-2">Side note: If you are wondering, like I was, how <code>floor</code> operation differs from <code>fract</code> operation, try and substitute!</p>
<h3 class="text-lg font-semibold">Grid + texture = ?</h3>
<p class="py-2">Since we have all the ingredients for our recipe, let's plug them into action and see what happens!</p>
<pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br>    <br>    <span class="token keyword">float</span> deg <span class="token operator">=</span> <span class="token number">4.0</span><span class="token punctuation">;</span><br>    <span class="token keyword">vec2</span> grid <span class="token operator">=</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token function">floor</span><span class="token punctuation">(</span>st<span class="token operator">*</span>deg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">vec2</span> tex_coord <span class="token operator">=</span> st<span class="token operator">+</span>grid<span class="token punctuation">;</span><br>    <span class="token keyword">vec4</span> tex <span class="token operator">=</span> <span class="token function">texture2D</span><span class="token punctuation">(</span>u_texture_0<span class="token punctuation">,</span> tex_coord<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    gl_FragColor <span class="token operator">=</span> tex<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p class="py-2"><img src="./post2-3.png" alt="almost there but not quite.."></p>
<p class="py-2">Oops what are these weird lines, we don't want those? Let us go back to what we said about texture coordinates. They range from 0 to 1, and since we are adding two vectors to each other, is it not possible for them to exceed this range..? What if we take only the <code>fract</code>ional part of the resulting vector?</p>
<pre class="language-glsl"><code class="language-glsl"><span class="token keyword">vec2</span> tex_coord <span class="token operator">=</span> <span class="token function">fract</span><span class="token punctuation">(</span>st<span class="token operator">+</span>grid<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p class="py-2">Voila, we've done it!</p>
<p class="py-2"><img src="./mess3.png" alt="'mess 3'"></p>
<p class="py-2">You can now try playing around with these different values, maybe change how you want to define the <code>deg</code> of pixelation.
Here are a few things I got while messing around.</p>
<p class="py-2"><img src="./mess2.png" alt="'mess 2'"></p>
<p class="py-2"><img src="./mess1.png" alt="'mess 1'"></p>
<p class="py-2"><img src="./hero.png" alt="'mess 4'"></p>
<p class="py-2">These looked much better in motion, but I haven't yet figured out how to use videos with Gatsby xD. You can try playing with motion as well by using the <code>u_time</code> uniform.
So until next time, which will hopefully be sooner, have fun! 💃</p>

    </div>

    <div class="w-full
                py-4 px-2">
      <footer>
  <ul class="markdown-list list-inside self-start">
    <li><a class="link-primary" href="https://www.instagram.com/ophelia.game/">instagram</a></li>
    <li><a class="link-primary" href="https://twitter.com/anushkatr">twitter</a></li>
  </ul>
</footer>

    </div>

  </div>

</body>
</html>
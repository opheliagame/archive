<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>opheliagame</title><base href="/"><link rel="preconnect" href="https://fonts.gstatic.com"><link rel="apple-touch-icon" sizes="180x180" href="assets/img/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="96x96" href="assets/img/favicons/android-chrome-192x192.png"><link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicons/android-chrome-384x384.png"><link rel="icon" type="image/png" sizes="16x16" href="assets/img/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32x32.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="theme-color" content="#54e4e5"><meta name="author" content="opheliagame"><meta name="description" content="visuals | text | code"><meta property="og:image" content="https://opheliagame.github.io/assets/img/favicon.ico"><meta property="og:description" content="visuals | text | code"><meta property="og:title" content="opheliagame"><meta property="twitter:description" content="visuals | text | code"><meta property="twitter:title" content="opheliagame"><meta property="twitter:creator" content="@anushkatr"><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@200;400;600&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400&display=swap" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prism-themes@1.7.0/themes/prism-material-light.css" rel="stylesheet"><link rel="stylesheet" href="/archive/assets/css/style.css"><link rel="stylesheet" href="/archive/assets/css/extra.css"><script defer="defer" src="https://unpkg.com/alpinejs@3.8.1/dist/cdn.min.js"></script><script type="module" src="/archive/assets/js/main.mjs"></script></head><body class="bg-pink-200 h-full"><div class="md:container md:mx-auto h-full flex flex-col items-center px-2 md:px-48"><div class="flex justify-between items-center w-full"><main-header></main-header><main-nav></main-nav></div><div class="px-2 w-full text-sm"><h3 class="text-lg md:text-xl font-semibold uppercase">Hello Shader!</h3><div class="flex flex-row gap-x-2"><main-tag name="shader"></main-tag><main-tag name="2021"></main-tag></div><div class="text-sm md:text-lg"><p class="py-2">Hey! Yes since I have never written for THE Web before this is how I'll start. This is probably not going to be very good since aforementioned haha but hopefully if you are as new to shaders as I am, and are learning them yourself, you might find something of value in here.</p><p class="py-2">This article is the start of a series of articles that I plan on writing about shaders while learning how to write them. Documenting the learning process in this way will hopefully help me understand what areas I have covered, where I feel comfortable, and which parts I should focus on next. I've always been someone who starts something but never really gets around to finishing it, and so I hope that I can finally end that with these articles and have more understanding after, let's say a month, of <a href="https://www.instagram.com/p/CLZmyd3B3vv/" class="link-primary" target="_blank" rel="noopener noreferrer">where I was and where I am headed</a>(<a href="https://www.instagram.com/kayserifserif/" class="link-primary" target="_blank" rel="noopener noreferrer">@kayserifserif</a>, thank you for the inspiration!)</p><h3 class="text-lg font-semibold">Aand it's shader time</h3><p class="py-2">Today I will be going through a shader I wrote to recreate an old sketch made in Processing.</p><p class="py-2"><picture><source type="image/avif" srcset="/assets/img/SOZQc7mnMG-300.avif 300w, /assets/img/SOZQc7mnMG-600.avif 600w" sizes="(min-width: 30em) 50vw, 100vw"><source type="image/jpeg" srcset="/assets/img/SOZQc7mnMG-300.jpeg 300w, /assets/img/SOZQc7mnMG-600.jpeg 600w" sizes="(min-width: 30em) 50vw, 100vw"><img alt="processing eye" loading="lazy" decoding="async" src="/assets/img/SOZQc7mnMG-300.jpeg" width="600" height="636"></picture></p><p class="py-2">The Processing code uses an Eye class and some vector math that I thought was a bit overkill for the idea of the sketch, which is to have two circles, one inside the other, with the inner circle responding to mouse movement, and sort of imitate human eyes 👀</p><p class="py-2">To try out this shader and experiment with your own, it is very simple and easy to use an extension in VSCode, there is hardly any setup required and you'll be able to see the output right inside your editor with changes being reflected as you type them. I have been using <a href="https://marketplace.visualstudio.com/items?itemName=circledev.glsl-canvas" class="link-primary" target="_blank" rel="noopener noreferrer">glsl-canvas</a> but there are a few others as well.</p><p class="py-2">For our simple purposes we only need to know how to make circles and make them move using glsl. If you haven't already heard of the <a href="https://thebookofshaders.com/" class="link-primary" target="_blank" rel="noopener noreferrer">Book of Shaders</a>, leave this simple minded article right now and head over there because I could never be as succint and amazing in explaining the smallest details or big picture ideas about shaders, and the site is just beautiful. 🖤 But if you already know a bit about Fragment Shaders, you'll know that we need a <code>main</code> function, some necessary directives and uniforms and a function to make a circle to begin with.</p><p class="py-2">The circle function takes as its input a vector describing the coordinate space of the canvas, a vector for the center of the circle in this coordinate space and a radius value. We're drawing the circle based on the distance between each pixel and the center of the circle. So a color will be calculated for each pixel based on how far it is from the center of the circle. I referred the Book of Shaders <a href="https://thebookofshaders.com/05/" class="link-primary" target="_blank" rel="noopener noreferrer">shaping</a> page myself because this part is not always easy to understand and it takes a lot of time and practice to develop the intuition that'll let you write amazing shaping functions in glsl. Bless us all, Mr Miyagi!</p><pre class="language-glsl"><code class="language-glsl"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">GL_ES</span></span><br><span class="token keyword">precision</span> <span class="token keyword">mediump</span> <span class="token keyword">float</span><span class="token punctuation">;</span><br><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span><br><br><span class="token keyword">uniform</span> <span class="token keyword">vec2</span> u_resolution<span class="token punctuation">;</span><br><span class="token keyword">uniform</span> <span class="token keyword">vec2</span> u_mouse<span class="token punctuation">;</span><br><span class="token keyword">uniform</span> <span class="token keyword">float</span> u_time<span class="token punctuation">;</span><br><br><span class="token keyword">float</span> <span class="token function">circle</span><span class="token punctuation">(</span><span class="token keyword">vec2</span> _st<span class="token punctuation">,</span> <span class="token keyword">vec2</span> _pos<span class="token punctuation">,</span> <span class="token keyword">float</span> _radius<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> dist <span class="token operator">=</span> _pos<span class="token operator">-</span>_st<span class="token punctuation">;</span><br>    dist <span class="token operator">*=</span> <span class="token number">0.5</span><span class="token punctuation">;</span><br>    <span class="token keyword">float</span> val <span class="token operator">=</span> <span class="token function">smoothstep</span><span class="token punctuation">(</span>_radius<span class="token operator">-</span><span class="token number">0.01</span><span class="token punctuation">,</span> _radius<span class="token operator">+</span><span class="token number">0.01</span><span class="token punctuation">,</span> <span class="token function">dot</span><span class="token punctuation">(</span>dist<span class="token punctuation">,</span>dist<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> val<span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><p class="py-2">But for now, since we are not using the circle function inside <code>main</code> you should only see red if you run this shader. On with circles, now ⚫⚪🔴</p><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> c <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">-</span><span class="token function">circle</span><span class="token punctuation">(</span><span class="token function">fract</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><p class="py-2">You might be wondering what is this <code>fract</code> business we've got going here and so I will try to explain. Inside our shader the coordinate space, i.e. <code>st</code> lies between 0.0 and 1.0 since we are normalizing using the resolution of the screen, <code>u_resolution</code>. <a href="https://thebookofshaders.com/glossary/?search=fract" class="link-primary" target="_blank" rel="noopener noreferrer">fract</a> is a glsl function that returns the fractional value of any number. I am using it here to be able to draw more than one circle while only using <code>vec(0.5)</code> as the location for all the circles. The subtraction in the beginning is to reverse the color of circle and background.</p><p class="py-2">To make the smaller circle within the bigger circle, we'll call the <code>circle</code> function again, giving it the same coordinate space and a smaller radius, but we don't want it to be stationary. Let's set the location as a function of the uniform <code>u_time</code>. We want the small circle to move in a circle(yay circles!), so by using <code>u_time</code> as our angle, we can calculate the x and y location</p><pre class="language-glsl"><code class="language-glsl">    x <span class="token operator">=</span> <span class="token function">cos</span><span class="token punctuation">(</span>u_time<span class="token punctuation">)</span> <span class="token operator">*</span> radius<br>    y <span class="token operator">=</span> <span class="token function">sin</span><span class="token punctuation">(</span>u_time<span class="token punctuation">)</span> <span class="token operator">*</span> radius</code></pre><p class="py-2">Finally we will add 0.5 as an offset to center the smaller circle within the big circle. When finally setting <code>gl_FragColor</code> in the last line, we will multiply the values for both circles. This would be equivalent to an <code>and</code> operation, in shader terms, combining both the results. Also notice how we subtract from 1.0 with only the bigger circle and not the smaller one. You could try playing with this to get a better feel for how things are working.</p><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> c <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">-</span><span class="token function">circle</span><span class="token punctuation">(</span><span class="token function">fract</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">float</span> smallc_len <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">;</span><br>    <span class="token keyword">vec2</span> smallc_pos <span class="token operator">=</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>u_time<span class="token punctuation">)</span><span class="token operator">*</span>smallc_len<span class="token punctuation">,</span> <span class="token function">sin</span><span class="token punctuation">(</span>u_time<span class="token punctuation">)</span><span class="token operator">*</span>smallc_len<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">;</span><br>    <span class="token keyword">float</span> smallc <span class="token operator">=</span> <span class="token function">circle</span><span class="token punctuation">(</span><span class="token function">fract</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">2.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span>smallc_pos<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>c<span class="token operator">*</span>smallc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br></code></pre><p class="py-2">The only thing remaining now is to add mouse interaction 🐁 since we don't want all the circles looking in the same direction, which is what happens if we use any uniform as that value would be the same for all our pixels.</p><p class="py-2">For this we'll first normalise the uniform <code>u_mouse</code> just like we normalised the coordinates. And then make a vector starting from the pixel position pointing towards the mouse. We can now use this vector to calculate an angle using inverse tangent.</p><pre class="language-glsl"><code class="language-glsl"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">vec2</span> st <span class="token operator">=</span> gl_FragCoord<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br>    <span class="token keyword">vec2</span> m <span class="token operator">=</span> u_mouse<span class="token punctuation">.</span>xy<span class="token operator">/</span>u_resolution<span class="token punctuation">.</span>xy<span class="token punctuation">;</span><br><br>    <span class="token keyword">vec2</span> dir <span class="token operator">=</span> m<span class="token operator">-</span>st<span class="token punctuation">;</span><br>    <span class="token keyword">float</span> dirangle <span class="token operator">=</span> <span class="token function">atan</span><span class="token punctuation">(</span>dir<span class="token punctuation">.</span>y<span class="token punctuation">,</span> dir<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">float</span> c <span class="token operator">=</span> <span class="token number">1.0</span><span class="token operator">-</span><span class="token function">circle</span><span class="token punctuation">(</span><span class="token function">fract</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">4.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    <span class="token keyword">float</span> smallc_len <span class="token operator">=</span> <span class="token number">0.25</span><span class="token punctuation">;</span><br>    <span class="token keyword">vec2</span> smallc_pos <span class="token operator">=</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span><span class="token function">cos</span><span class="token punctuation">(</span>dirangle<span class="token punctuation">)</span><span class="token operator">*</span>smallc_len<span class="token punctuation">,</span> <span class="token function">sin</span><span class="token punctuation">(</span>dirangle<span class="token punctuation">)</span><span class="token operator">*</span>smallc_len<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">;</span><br>    <span class="token keyword">float</span> smallc <span class="token operator">=</span> <span class="token function">circle</span><span class="token punctuation">(</span><span class="token function">fract</span><span class="token punctuation">(</span>st<span class="token operator">*</span><span class="token number">4.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">vec2</span><span class="token punctuation">(</span>smallc_pos<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br>    gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span><span class="token keyword">vec3</span><span class="token punctuation">(</span>c<span class="token operator">*</span>smallc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre><p class="py-2">And if we just plug this angle into our smaller circles, tada, we have our shader!</p><p class="py-2"><picture><source type="image/avif" srcset="/assets/img/-hHnvl3GUY-300.avif 300w, /assets/img/-hHnvl3GUY-600.avif 600w" sizes="(min-width: 30em) 50vw, 100vw"><source type="image/jpeg" srcset="/assets/img/-hHnvl3GUY-300.jpeg 300w, /assets/img/-hHnvl3GUY-600.jpeg 600w" sizes="(min-width: 30em) 50vw, 100vw"><img alt="final gif" loading="lazy" decoding="async" src="/assets/img/-hHnvl3GUY-300.jpeg" width="600" height="617"></picture></p><p class="py-2">If you have something to share, thoughts about this article, or any mistakes that you thought were made(very probable), please feel free to reach out to me on Instagram, link in footer. 💃 That's all for this time, hopefully there will be more soon.</p></div></div><div class="w-full py-4 px-2 mt-auto"><main-footer></main-footer></div></div><script src="/archive/assets/js/sign.js"></script></body></html>